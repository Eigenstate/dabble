<!DOCTYPE html>
<html class="writer-html5" lang="python" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parameterization with Dabble &mdash; Dabble 2.8.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
    <link rel="canonical" href="https://dabble.robinbetz.com/parameter_api.html"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=451a52d5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Covalent modifications with CHARMM parameters" href="charmmcovalent.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/dabblelogosmall.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.8.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Parameterization with Dabble</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#automatic-atom-naming">Automatic atom naming</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dabble.param.MoleculeMatcher"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.topologies"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.topologies</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.known_res"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.known_res</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.known_pres"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.known_pres</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.patches"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.patches</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.nodenames"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.nodenames</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.pseudoatoms"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.pseudoatoms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.get_element"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.get_element()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.get_extraresidue_atoms"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.get_extraresidue_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.get_names"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.get_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.parse_vmd_graph"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.parse_vmd_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.MoleculeMatcher.write_dot"><code class="docutils literal notranslate"><span class="pre">MoleculeMatcher.write_dot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#generation-of-simulation-input-files">Generation of simulation input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#amber-specific-parameterization">Amber-specific Parameterization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dabble.param.AmberMatcher"><code class="docutils literal notranslate"><span class="pre">AmberMatcher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.topologies"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.topologies</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.known_res"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.known_res</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.nodenames"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.nodenames</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.get_disulfide"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.get_disulfide()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.get_linkage"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.get_linkage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.get_lipid_head"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.get_lipid_head()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.get_lipid_tails"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.get_lipid_tails()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.get_names"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.get_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberMatcher.get_unit"><code class="docutils literal notranslate"><span class="pre">AmberMatcher.get_unit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dabble.param.AmberWriter"><code class="docutils literal notranslate"><span class="pre">AmberWriter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.AmberWriter.write"><code class="docutils literal notranslate"><span class="pre">AmberWriter.write()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#charmm-specific-parameterization">Charmm-specific Parameterization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dabble.param.CharmmMatcher"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.topologies"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.topologies</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.known_res"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.known_res</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.nodenames"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.nodenames</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.known_pres"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.known_pres</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.patches"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.patches</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.get_disulfide"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.get_disulfide()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.get_names"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.get_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.get_patches"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.get_patches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmMatcher.get_protein_segname"><code class="docutils literal notranslate"><span class="pre">CharmmMatcher.get_protein_segname()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dabble.param.CharmmWriter"><code class="docutils literal notranslate"><span class="pre">CharmmWriter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dabble.param.CharmmWriter.write"><code class="docutils literal notranslate"><span class="pre">CharmmWriter.write()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Dabble</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Parameterization with Dabble</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/parameter_api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="parameterization-with-dabble">
<span id="parameter-api"></span><h1>Parameterization with Dabble<a class="headerlink" href="#parameterization-with-dabble" title="Link to this heading">¶</a></h1>
<p>Regardless of simulation program or force field, parameterizing a
molecular system consists of several steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Parse the library of known residues provided by the forcefield</p></li>
<li><p><a class="reference internal" href="#match-system-residues">Match system residues</a> to those in library</p></li>
<li><p>Assign residue and atom names based on matching</p></li>
<li><p><a class="reference internal" href="#invoke-simulation-package-preparatory-program">Invoke simulation package preparatory program</a> to build
input files.</p></li>
</ol>
</div></blockquote>
<p>Pretty much all simulation package prepatory programs require that
atom names match the defined residue types, and cannot match up for
you. This resuls in many awkward work arounds, such as large dictionaries
of name translations for each amino acid from RSC PDB names to the
required ones, and tedious work on the part of the user for ligands.</p>
<p>Dabble does all of this work for you, and is in fact completely
agnostic to the atom names in the input file. It does this by representing
each residue as an undirected graph, with nodes being atoms. A library
of these graphs is generated from provided parameter and topology files,
and graph isomorphism is used to match up system residues to those in the
library based on element.</p>
<p>As protein residues are in a long chain, the graph representation is
a little trickier. Using the same philosophy as the CHARMM and AMBER
parameter sets, &quot;special&quot; atoms called <cite>+</cite> and <cite>-</cite> are attached to represent
the next and previous amino acid in the chain. This does require that
all protein residues are correctly represented in the input file, that
is, each resid does correspond to an entire amino acid.</p>
<p>There are several tweaks to this process depending on the desired output
format. For example, CHARMM has the concept of &quot;patches&quot; that can be applied
on top of residues. Dabble can detect and apply these correctly.</p>
<p>The following API functions are called on the built system from
Dabble's builder, but you can use them on systems you have already
built as well, or extend them to other systems.</p>
<section id="automatic-atom-naming">
<span id="match-system-residues"></span><h2>Automatic atom naming<a class="headerlink" href="#automatic-atom-naming" title="Link to this heading">¶</a></h2>
<p>Atom matching classes inherit from <code class="docutils literal notranslate"><span class="pre">MoleculeMatcher</span></code>, which
defines basic functionality for matching:</p>
<dl class="py class">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dabble.param.</span></span><span class="sig-name descname"><span class="pre">MoleculeMatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.MoleculeMatcher" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Represents a collection of graphs of all residues defined in the
topology files. Can pass in VMD molecules to be checked and atom
names corrected</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.topologies">
<span class="sig-name descname"><span class="pre">topologies</span></span><a class="headerlink" href="#dabble.param.MoleculeMatcher.topologies" title="Link to this definition">¶</a></dt>
<dd><p>The topology files this molecule graph
knows about</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.known_res">
<span class="sig-name descname"><span class="pre">known_res</span></span><a class="headerlink" href="#dabble.param.MoleculeMatcher.known_res" title="Link to this definition">¶</a></dt>
<dd><p>The molecule graphs</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict str resname -&gt; networkx graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.known_pres">
<span class="sig-name descname"><span class="pre">known_pres</span></span><a class="headerlink" href="#dabble.param.MoleculeMatcher.known_pres" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict tuple (str resname, patchname) -&gt; networkx graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.patches">
<span class="sig-name descname"><span class="pre">patches</span></span><a class="headerlink" href="#dabble.param.MoleculeMatcher.patches" title="Link to this definition">¶</a></dt>
<dd><p>Known patches</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict patchname -&gt; str instructions</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.nodenames">
<span class="sig-name descname"><span class="pre">nodenames</span></span><a class="headerlink" href="#dabble.param.MoleculeMatcher.nodenames" title="Link to this definition">¶</a></dt>
<dd><p>Translates atom names to
elements</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict name -&gt; element</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.pseudoatoms">
<span class="sig-name descname"><span class="pre">pseudoatoms</span></span><a class="headerlink" href="#dabble.param.MoleculeMatcher.pseudoatoms" title="Link to this definition">¶</a></dt>
<dd><p>Atom types for pseudo or dummy atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.get_element">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.MoleculeMatcher.get_element" title="Link to this definition">¶</a></dt>
<dd><p>Returns the element corresponding to a given mass. Masses are rounded
up to get atomic number to control for varying numbers of decimal
places. If the mass isn't in the table (it's not complete), returns
&quot;Other&quot; which should be sufficient for our matching purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mass</strong> (<em>float</em>) -- Mass to look up</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element corresponding to the mass, or &quot;Other&quot;</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.get_extraresidue_atoms">
<span class="sig-name descname"><span class="pre">get_extraresidue_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.MoleculeMatcher.get_extraresidue_atoms" title="Link to this definition">¶</a></dt>
<dd><p>Determines if this selection contains bonds to other things. We</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>selection</strong> (<em>atomsel</em>) -- Selection to check</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List of indices of atoms belonging to other</dt><dd><p>residues, or an empty list</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(list of int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.get_names">
<span class="sig-name descname"><span class="pre">get_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.MoleculeMatcher.get_names" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a name mapping for the current selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to set names for</p></li>
<li><p><strong>print_warning</strong> (<em>bool</em>) -- Whether or not to print matching suggestions
if matching fails. Set to false if you'll try patches later.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(dict int-&gt;str) Atom index to resname matched
(dict int-&gt;str) Atom index to atom name matched up</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> -- if no matching possible</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.parse_vmd_graph">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_vmd_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.MoleculeMatcher.parse_vmd_graph" title="Link to this definition">¶</a></dt>
<dd><p>Takes a VMD atom selection, translates it to a graph representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Atom selection to verify, modified.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Intermediate representation of the
molecule, and True if the selection is covalently bonded to another
residue.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(networkx.Graph, bool)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError if atom selection is more than one residue</strong> -- </p></li>
<li><p><strong>LookupError if the residue couldn't be found in known templates</strong> -- </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.MoleculeMatcher.write_dot">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.MoleculeMatcher.write_dot" title="Link to this definition">¶</a></dt>
<dd><p>Writes the residue as a dot file that can be rendered as a SVG
to aid in debugging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<em>networkx Graph</em>) -- Graph to draw</p></li>
<li><p><strong>output</strong> (<em>str</em>) -- Filename to write to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="generation-of-simulation-input-files">
<span id="invoke-simulation-package-preparatory-program"></span><h2>Generation of simulation input files<a class="headerlink" href="#generation-of-simulation-input-files" title="Link to this heading">¶</a></h2>
<p>Simulation input files are generated by a preparatory program specific
to that package. Dabble invokes this program instead of generating files
itself as functionality may change, and application of correct forcefield
parameters can be challenging. Also, there is no reason to reinvent the wheel.</p>
<p>For CHARMM, Dabble invokes the VMD plugin <cite>psfgen</cite>, and for AMBER, <cite>tleap</cite>.
Dabble generates an input file for these programs, invokes them, and
checks the output for correctness.</p>
<p>The design philosophy here is that this should be accomplished by a
<code class="docutils literal notranslate"><span class="pre">Writer</span></code> class, that when initialized with a VMD molecule ID corresponding
to the built system  as well as parameter and/or topology files to be applied.
It invokes the atom matching, then generates a new molecule
with corrected atom and residue names. Invoking <code class="docutils literal notranslate"><span class="pre">Writer.write</span></code> with an
output file name then generates an input file for and calls the setup program,
checking the output along the way.</p>
</section>
<section id="amber-specific-parameterization">
<h2>Amber-specific Parameterization<a class="headerlink" href="#amber-specific-parameterization" title="Link to this heading">¶</a></h2>
<p>Atom name matching in AMBER has functionality specific to the
modular head/tail representation of lipids, as well as identification
of disulfide bonds.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dabble.param.</span></span><span class="sig-name descname"><span class="pre">AmberMatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topologies</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberMatcher" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dabble.param.MoleculeMatcher" title="dabble.param.moleculematcher.MoleculeMatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">MoleculeMatcher</span></code></a></p>
<p>Matches up names and residues for molecules for use with leap and
the amber stack of preparatory programs</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.topologies">
<span class="sig-name descname"><span class="pre">topologies</span></span><a class="headerlink" href="#dabble.param.AmberMatcher.topologies" title="Link to this definition">¶</a></dt>
<dd><p>The topology files this molecule graph
knows about. For amber, these are leaprc files.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.known_res">
<span class="sig-name descname"><span class="pre">known_res</span></span><a class="headerlink" href="#dabble.param.AmberMatcher.known_res" title="Link to this definition">¶</a></dt>
<dd><p>The molecule graphs</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict str resname -&gt; networkx graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.nodenames">
<span class="sig-name descname"><span class="pre">nodenames</span></span><a class="headerlink" href="#dabble.param.AmberMatcher.nodenames" title="Link to this definition">¶</a></dt>
<dd><p>Translates atom names to
elements</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict name -&gt; element</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.get_disulfide">
<span class="sig-name descname"><span class="pre">get_disulfide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberMatcher.get_disulfide" title="Link to this definition">¶</a></dt>
<dd><p>Checks if the selection corresponds to a cysteine in a disulfide bond.
Sets the patch line appropriately and matches atom names using
a subgraph match to the normal cysteine residue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to check</p></li>
<li><p><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to look for other CYS in</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resnames (dict int -&gt; str) Residue name translation dictionary
atomnames (dict int -&gt; str) Atom name translation dictionary
conect (int) Residue this one is connected to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.get_linkage">
<span class="sig-name descname"><span class="pre">get_linkage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberMatcher.get_linkage" title="Link to this definition">¶</a></dt>
<dd><p>Checks if the selection corresponds to a residue that is covalently
bonded to some other residue other than the normal + or - peptide bonds.
Sets the patch line (bond line for leap) appropriately and matches
atom names using a maximal subgraph isomorphism to the normal residue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to check</p></li>
<li><p><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to look for other bonded residue in</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resnames (dict int -&gt; str) Residue name translation dictionary
atomnames (dict int -&gt; str) Atom name translation dictionary
conect (str) Leap patch line to apply for this linkage</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.get_lipid_head">
<span class="sig-name descname"><span class="pre">get_lipid_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberMatcher.get_lipid_head" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a name mapping for a lipid head group given a selection
describing a possible lipid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to set names for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(dict int-&gt;str) Atom index to resname matched
(dict int-&gt;str) Atom index to atom name matched up
(int) Atom index corresponding to - direction tail</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> -- if no matching possible</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.get_lipid_tails">
<span class="sig-name descname"><span class="pre">get_lipid_tails</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberMatcher.get_lipid_tails" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a name mapping for both ligand tails in a system given
a selection describing the lipid and the indices of the head
group atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to pull tails from</p></li>
<li><p><strong>head</strong> (<em>list</em><em> of </em><em>int</em>) -- Atom indices in the head group of this lipid.
Obtain with get_lipid_head function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Atom index to</dt><dd><p>resname matched, atom index to atom name translation
dictionaries for both tails</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(array of tuples that are dict int-&gt;str)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> -- If a tail could not be matched or if there is an
    incorrect number of tails somehow attached.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.get_names">
<span class="sig-name descname"><span class="pre">get_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberMatcher.get_names" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a name mapping for the current selection. Can't use
parent here since name is stored in a different field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to set names for</p></li>
<li><p><strong>print_warning</strong> (<em>bool</em>) -- Whether or not to print matching suggestions
if matching fails. Set to false if you'll try patches later.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(dict int-&gt;str) Atom index to resname matched
(dict int-&gt;str) Atom index to atom name matched up</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> -- if no matching possible</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.AmberMatcher.get_unit">
<span class="sig-name descname"><span class="pre">get_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberMatcher.get_unit" title="Link to this definition">¶</a></dt>
<dd><p>Gets the UNIT name corresponding to a selection. Helpful when matching
ligands that may have a residue name different from unit name since
the average user doesn't know what a unit name is when creating a library.
This isn't as efficient as it could be because it is called
infrequently, on ligands only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to check</p></li>
<li><p><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to look in</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(str) The unit name, or None if there was no match</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">AmberWriter</span></code> class requires an installation of AmberTools in
<code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code>, enabling the use of the most up to date forcefields and
bugfixes. The following parameter and topology sets are used by default:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">ff14SB</span>
<span class="o">-</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">lipid14</span>
<span class="o">-</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">lipid16</span>
<span class="o">-</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">water</span><span class="o">.</span><span class="n">tip3p</span>
<span class="o">-</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">gaff2</span>
</pre></div>
</div>
<p>The <cite>tleap</cite> program is used to do the parameterization, and the ParmEd
API then applies HMR if desired, and checks the result.</p>
<p>If the user is asking for input files for AMBER using CHARMM parameters,
the <code class="docutils literal notranslate"><span class="pre">AmberWriter</span></code> class can also take the molecule ID of a
CHARMM-parameterized molecule, and invoke <code class="docutils literal notranslate"><span class="pre">chamber</span></code> through the ParmEd
API to convert to the AMBER format.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dabble.param.AmberWriter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dabble.param.</span></span><span class="sig-name descname"><span class="pre">AmberWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molid</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberWriter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MoleculeWriter</span></code></p>
<p>Creates AMBER-format input files, using either CHARMM or AMBER parameters.</p>
<p>When using the CHARMM parameters, creates a psf/pdb file and interfaces
with ParmEd chamber command to create AMBER format files.
When using the AMBER parameters, creates a pdb file and runs the amber
lipid conversion script to create leap input files.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.AmberWriter.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.AmberWriter.write" title="Link to this definition">¶</a></dt>
<dd><p>Writes the parameter and topology files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) -- File name to write. File type suffix will be added.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="charmm-specific-parameterization">
<h2>Charmm-specific Parameterization<a class="headerlink" href="#charmm-specific-parameterization" title="Link to this heading">¶</a></h2>
<p>Atom name matching in CHARMM is somewhat complicated by the fact that
patches are allowed. Patches represent modifications to residues, and
may be applied to any residue although in reality are only chemically
valid for a subset of them. An example of a patch is the addition of
a disulfide bond between two residues (DISU), or a cap on the N-terminal
end of the protein (NTER, ACE).</p>
<p>If a residue cannot be matched from the provided topology definitions,
Dabble's graph matching functionality generates a library of valid
patch applications and attempts to match there, adding the relevant
patches if a match is found. Subgraph isomorphism is used to help
trim the size of this library.</p>
<p>With the exception of disulfide bonds,
patches involving only one residue are currently supported.</p>
<p>Note that this requires patch atoms to be in the same residue. This
can pose a challenge to recognition of caps, which are applied as
separate residues in some protein preparation workflows (notably
Maestro).</p>
<dl class="py class">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dabble.param.</span></span><span class="sig-name descname"><span class="pre">CharmmMatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topologies</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.CharmmMatcher" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dabble.param.MoleculeMatcher" title="dabble.param.moleculematcher.MoleculeMatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">MoleculeMatcher</span></code></a></p>
<p>Represents a collection of graphs of all residues defined in the
topology files. Can pass in VMD molecules to be checked and atom
names corrected</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.topologies">
<span class="sig-name descname"><span class="pre">topologies</span></span><a class="headerlink" href="#dabble.param.CharmmMatcher.topologies" title="Link to this definition">¶</a></dt>
<dd><p>The topology files this molecule graph
knows about, from parent class</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.known_res">
<span class="sig-name descname"><span class="pre">known_res</span></span><a class="headerlink" href="#dabble.param.CharmmMatcher.known_res" title="Link to this definition">¶</a></dt>
<dd><p>The molecule graphs,
from parent class</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict str resname -&gt; networkx graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.nodenames">
<span class="sig-name descname"><span class="pre">nodenames</span></span><a class="headerlink" href="#dabble.param.CharmmMatcher.nodenames" title="Link to this definition">¶</a></dt>
<dd><p>Translates atom names to
elements, from parent class</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict name -&gt; element</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.known_pres">
<span class="sig-name descname"><span class="pre">known_pres</span></span><a class="headerlink" href="#dabble.param.CharmmMatcher.known_pres" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict tuple (str resname, patchname) -&gt; networkx graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.patches">
<span class="sig-name descname"><span class="pre">patches</span></span><a class="headerlink" href="#dabble.param.CharmmMatcher.patches" title="Link to this definition">¶</a></dt>
<dd><p>Known patches</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict patchname -&gt; str instructions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.get_disulfide">
<span class="sig-name descname"><span class="pre">get_disulfide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selstring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.CharmmMatcher.get_disulfide" title="Link to this definition">¶</a></dt>
<dd><p>Checks if the selection corresponds to a cysteine in a disulfide bond.
Sets the patch line appropriately and matches atom names using
a subgraph match to the normal cysteine residue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selstring</strong> (<em>str</em>) -- Selection to check</p></li>
<li><p><strong>molid</strong> (<em>int</em>) -- VMD molecule of entire system (needed for disu partner)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(str, Patch, dict) resname matched, patch object for psfgen,</dt><dd><p>name translation dictionary</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.get_names">
<span class="sig-name descname"><span class="pre">get_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.CharmmMatcher.get_names" title="Link to this definition">¶</a></dt>
<dd><p>Returns at atom name matching up dictionary.
Does the generic moleculematcher algorithm then checks that only
one resname matched since for CHARMM there is no concept
of a unit and only one named residue is defined per topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection to rename</p></li>
<li><p><strong>print_warning</strong> (<em>bool</em>) -- Debug output</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(str) resname matched
(dict int-&gt;str) translation dictionary from index to atom name</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError if more than one residue name is matched</strong> -- </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.get_patches">
<span class="sig-name descname"><span class="pre">get_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.CharmmMatcher.get_patches" title="Link to this definition">¶</a></dt>
<dd><p>Obtains names and patch info for a modified residue in a selection.
Identifies which amino acid is patched by finding which amino acid
this one is a maximal subgraph of. Then, builds a library of graphs
representing all valid patches applied to this amino acid.</p>
<p>Note that this does NOT handle multiple-residue patches such as
disulfides!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>selection</strong> (<em>VMD atomsel</em>) -- Selection that is patched</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(str, str, dict) resname matched, patch name applied,</dt><dd><p>name translation dictionary</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.CharmmMatcher.get_protein_segname">
<span class="sig-name descname"><span class="pre">get_protein_segname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.CharmmMatcher.get_protein_segname" title="Link to this definition">¶</a></dt>
<dd><p>Gets the segment name from a given protein fragment.
Sometimes fragment numbers for protein can be quite large if there
are a lot of other molecules in the system. This method returns a
consistent segment name for a given protein fragment.</p>
</dd></dl>

</dd></dl>

<p>The VMD plugin <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/plugins/psfgen/">psfgen</a> is
used to generate parameterized files with CHARMM parameters. Dabble uses the
<a class="reference external" href="https://psfgen.robinbetz.com">Python interface to psfgen</a> to invoke this
code, and handles all its quirks (such as not allowing segments
to have more than 10,000 atoms because its PDB parser is the worst).</p>
<dl class="py class">
<dt class="sig sig-object py" id="dabble.param.CharmmWriter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dabble.param.</span></span><span class="sig-name descname"><span class="pre">CharmmWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molid</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.CharmmWriter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MoleculeWriter</span></code></p>
<p>An object that handles all the conversions to a psf file
by interfacing with psfgen.</p>
<p>Writes a pdb/psf file pair from the current molecule using the
CHARMM36 topology and atom names/types. Interfaces with psfgen by
dynamically generating the .tcl file that psfgen takes as input.
Prompts the user for additional topology files and helps with
matching atom names that cannot be automatically translated to the
charmm naming conventions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dabble.param.CharmmWriter.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dabble.param.CharmmWriter.write" title="Link to this definition">¶</a></dt>
<dd><p>Writes the parameter and topology files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) -- File name to write. File type suffix will be added.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="charmmcovalent.html" class="btn btn-neutral float-left" title="Covalent modifications with CHARMM parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Robin Betz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>