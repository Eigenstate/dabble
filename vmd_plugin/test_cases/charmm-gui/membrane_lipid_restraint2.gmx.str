* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) VERSION on Jan, 12. 2015.
* DIHEDRAL RESTRAINT POTENTIALS FOR LIPID BILAYER
*

! dihedral restraints for double bond cis conformation
define test sele none end
define test sele chem cel1 .and. ires 1 .and. segid memb .and. .not. ( resn chl1 .or. resn erg ) show end
calc maxidih = ?nsel / 2
if ?nsel .gt. 0 then

   set idih = 1
   set atom2 = 1

   label idih 

      coor stat sele chem cel1 .and. ires 1 .and. segid memb .and. .not. bynu 1:@atom2 show end
      set atom1 = ?selatom
      coor stat sele chem cel1 .and. .bonded. bynu @atom1 show end
      set atom2 = ?selatom
      coor stat sele type C* .and. .bonded. bynu @atom1 .and. .not. bynu @atom2 end
      set atom0 = ?selatom
      coor stat sele type C* .and. .bonded. bynu @atom2 .and. .not. bynu @atom1 end
      set atom3 = ?selatom

      write title unit 53
      * MEMB DIH @atom0 @atom1 @atom2 @atom3 0.0 0.0
      *

   incr idih by 1
   if idih .le. @maxidih goto idih

endif

! trans-double bond
!
define test sele none end
define test sele chem cel3 .and. ires 1 .and. segid memb show end
calc maxidih = ?nsel / 2
if ?nsel .gt. 0 then

   set idih = 1
   set atom2 = 1

   label transdih

      coor stat sele chem cel3 .and. ires 1 .and. segid memb .and. .not. bynu 1:@atom2 show end  !  don't double count the same double bond
      set atom1 = ?selatom
      coor stat sele chem cel3 .and. .bonded. bynu @atom1 show end
      set atom2 = ?selatom
      coor stat sele type C* .and. .bonded. bynu @atom1 .and. .not. bynu @atom2 end
      set atom0 = ?selatom
      coor stat sele type C* .and. .bonded. bynu @atom2 .and. .not. bynu @atom1 end
      set atom3 = ?selatom

      write title unit 53
      * MEMB DIH @atom0 @atom1 @atom2 @atom3 180.0 0.0
      *

   incr idih by 1
   if idih .le. @maxidih goto transdih

endif

coor stat sele segid MEMB .and. ires 1 end
set lipid = ?selresn

!
! THE C22-C23 TRANS DOUBLE BOND FOR ERGOSTERL
!
if lipid .eq. ERG then

    coor stat sele segid MEMB .and. ires 1 .and. type C20 end
    set atom0 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C22 end
    set atom1 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C23 end
    set atom2 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C24 end
    set atom3 = ?selatom

    write title unit 53
    * MEMB DIH @atom0 @atom1 @atom2 @atom3 180.0 0.0
    *

endif

! dihedral restraints for L-glyceride
set iscl = no
if lipid .eq.  TMCL1 set iscl = ok
if lipid .eq.  TMCL2 set iscl = ok
if lipid .eq.  PMCL1 set iscl = ok
if lipid .eq.  PMCL2 set iscl = ok
if lipid .eq.  PVCL2 set iscl = ok
if lipid .eq.  TXCL1 set iscl = ok
if lipid .eq.  TXCL2 set iscl = ok
if lipid .eq.  TOCL1 set iscl = ok
if lipid .eq.  TOCL2 set iscl = ok
if lipid .eq. LOACL1 set iscl = ok
if lipid .eq. LOACL2 set iscl = ok
if lipid .eq. LOCCL1 set iscl = ok
if lipid .eq. LOCCL2 set iscl = ok
if lipid .eq.  TLCL1 set iscl = ok
if lipid .eq.  TLCL2 set iscl = ok
if lipid .eq. LNCCL1 set iscl = ok
if lipid .eq. LNCCL2 set iscl = ok
if lipid .eq. LNACL1 set iscl = ok
if lipid .eq. LNACL2 set iscl = ok
if lipid .eq. LNDCL1 set iscl = ok
if lipid .eq. LNDCL2 set iscl = ok
if lipid .eq. LNBCL1 set iscl = ok
if lipid .eq. LNBCL2 set iscl = ok
if lipid .eq.    PSM set iscl = sph
if lipid .eq.    SSM set iscl = sph
if lipid .eq.    ASM set iscl = sph
if lipid .eq.    BSM set iscl = sph
if lipid .eq.   23SM set iscl = sph
if lipid .eq.    LSM set iscl = sph
if lipid .eq.    OSM set iscl = sph
if lipid .eq.    NSM set iscl = sph
if lipid .eq. CER160 set iscl = sph
if lipid .eq. CER180 set iscl = sph
if lipid .eq. CER181 set iscl = sph
if lipid .eq. CER200 set iscl = sph
if lipid .eq. CER220 set iscl = sph
if lipid .eq. CER240 set iscl = sph
if lipid .eq. CER241 set iscl = sph

if iscl .eq. ok then

    coor stat sele segid MEMB .and. ires 1 .and. type C13 end
    set atom0 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C11 end
    set atom1 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C12 end
    set atom2 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type O12 end
    set atom3 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C33 end
    set atom4 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C31 end
    set atom5 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C32 end
    set atom6 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type O32 end
    set atom7 = ?selatom

    write title unit 53
    * MEMB DIH @atom0 @atom1 @atom2 @atom3 120.0 2.5
    * MEMB DIH @atom4 @atom5 @atom6 @atom7 120.0 2.5
    *

   goto skipc2
endif

define test sele none end
define test sele segid memb .and. ires 1 .and. ( type c3 .or. type c1 .or. type c2 .or. type o21 ) end
if ?nsel .eq. 4 then

    coor stat sele segid MEMB .and. ires 1 .and. type C3 end
    set atom0 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C1 end
    set atom1 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C2 end
    set atom2 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type O21 end
    set atom3 = ?selatom

    write title unit 53
    * MEMB DIH @atom0 @atom1 @atom2 @atom3 120.0 2.5
    *

endif

label skipc2

! dihedral restraints for inositol ring chair conformation
! dihedral restraints for inositol ring upright
set ispi = no
if lipid .eq.   DMPI set ispi = ok
if lipid .eq. DMPI13 set ispi = ok
if lipid .eq. DMPI14 set ispi = ok
if lipid .eq. DMPI15 set ispi = ok
if lipid .eq. DMPI24 set ispi = ok
if lipid .eq. DMPI25 set ispi = ok
if lipid .eq. DMPI33 set ispi = ok
if lipid .eq. DMPI34 set ispi = ok
if lipid .eq. DMPI35 set ispi = ok
if lipid .eq.   PYPI set ispi = ok
if lipid .eq.   POPI set ispi = ok
if lipid .eq. POPI13 set ispi = ok
if lipid .eq. POPI14 set ispi = ok
if lipid .eq. POPI15 set ispi = ok
if lipid .eq. POPI24 set ispi = ok
if lipid .eq. POPI25 set ispi = ok
if lipid .eq. POPI33 set ispi = ok
if lipid .eq. POPI34 set ispi = ok
if lipid .eq. POPI35 set ispi = ok
if lipid .eq.   PLPI set ispi = ok
if lipid .eq. PLPI13 set ispi = ok
if lipid .eq. PLPI14 set ispi = ok
if lipid .eq. PLPI15 set ispi = ok
if lipid .eq. PLPI24 set ispi = ok
if lipid .eq. PLPI25 set ispi = ok
if lipid .eq. PLPI33 set ispi = ok
if lipid .eq. PLPI34 set ispi = ok
if lipid .eq. PLPI35 set ispi = ok
if lipid .eq.   PNPI set ispi = ok
if lipid .eq. PNPI13 set ispi = ok
if lipid .eq. PNPI14 set ispi = ok
if lipid .eq. PNPI15 set ispi = ok
if lipid .eq. PNPI24 set ispi = ok
if lipid .eq. PNPI25 set ispi = ok
if lipid .eq. PNPI33 set ispi = ok
if lipid .eq. PNPI34 set ispi = ok
if lipid .eq. PNPI35 set ispi = ok
if lipid .eq.   SAPI set ispi = ok
if lipid .eq. SAPI13 set ispi = ok
if lipid .eq. SAPI14 set ispi = ok
if lipid .eq. SAPI15 set ispi = ok
if lipid .eq. SAPI24 set ispi = ok
if lipid .eq. SAPI25 set ispi = ok
if lipid .eq. SAPI33 set ispi = ok
if lipid .eq. SAPI34 set ispi = ok
if lipid .eq. SAPI35 set ispi = ok

if ispi .eq. ok then

    coor stat sele segid MEMB .and. ires 1 .and. type C11 end
    set atom0 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C12 end
    set atom1 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C13 end
    set atom2 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C14 end
    set atom3 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C15 end
    set atom4 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type C16 end
    set atom5 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type O12 end
    set atom6 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type P end
    set atom7 = ?selatom
    coor stat sele segid MEMB .and. ires 1 .and. type O11 end
    set atom8 = ?selatom

    write title unit 53
    * MEMB DIH @atom0 @atom1 @atom2 @atom3 60.0 2.5
    * MEMB DIH @atom1 @atom2 @atom3 @atom4 -60.0 2.5
    * MEMB DIH @atom2 @atom3 @atom4 @atom5 60.0 2.5
    * MEMB DIH @atom3 @atom4 @atom5 @atom0 -60.0 2.5
    * MEMB DIH @atom4 @atom5 @atom0 @atom1 60.0 2.5
    * MEMB DIH @atom5 @atom0 @atom1 @atom2 -60.0 2.5
    * MEMB DIH @atom0 @atom6 @atom7 @atom8 180.0 5.0
    *

endif   

return