* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) VERSION on Jan, 12. 2015.
* DIHEDRAL RESTRAINT POTENTIALS FOR CARBOHYDRATES
*

define XXX sele ( resn *DG .or. resn *DM ) show end

if ?nsel .eq. 0 goto skipcarb

define JUNK sele XXX .and. ires 1 show end
set resn = ?selresn

set isdm = no
if resn .eq. ADDM set isdm = yes
if resn .eq. BDDM set isdm = yes
if resn .eq. ADM  set isdm = yes
if resn .eq. BDM  set isdm = yes

!
! maltoside
!
if isdm .eq. yes then

   coor stat sele JUNK .and. type 1O5 end
   set atom0 = ?selatom
   coor stat sele JUNK .and. type 1C1 end
   set atom1 = ?selatom
   coor stat sele JUNK .and. type 1C2 end
   set atom2 = ?selatom
   coor stat sele JUNK .and. type 1C3 end
   set atom3 = ?selatom
   coor stat sele JUNK .and. type 1C4 end
   set atom4 = ?selatom
   coor stat sele JUNK .and. type 1C5 end
   set atom5 = ?selatom

   write title unit 53
   * CARB DIH @atom0 @atom1 @atom2 @atom3 60.0 2.5
   * CARB DIH @atom1 @atom2 @atom3 @atom4 -60.0 2.5
   * CARB DIH @atom2 @atom3 @atom4 @atom5 60.0 2.5
   * CARB DIH @atom3 @atom4 @atom5 @atom0 -60.0 2.5
   * CARB DIH @atom4 @atom5 @atom0 @atom1 60.0 2.5
   * CARB DIH @atom5 @atom0 @atom1 @atom2 -60.0 2.5
   *

endif

coor stat sele JUNK .and. type 2O5 end
set atom0 = ?selatom
coor stat sele JUNK .and. type 2C1 end
set atom1 = ?selatom
coor stat sele JUNK .and. type 2C2 end
set atom2 = ?selatom
coor stat sele JUNK .and. type 2C3 end
set atom3 = ?selatom
coor stat sele JUNK .and. type 2C4 end
set atom4 = ?selatom
coor stat sele JUNK .and. type 2C5 end
set atom5 = ?selatom

write title unit 53
* CARB DIH @atom0 @atom1 @atom2 @atom3 60.0 2.5
* CARB DIH @atom1 @atom2 @atom3 @atom4 -60.0 2.5
* CARB DIH @atom2 @atom3 @atom4 @atom5 60.0 2.5
* CARB DIH @atom3 @atom4 @atom5 @atom0 -60.0 2.5
* CARB DIH @atom4 @atom5 @atom0 @atom1 60.0 2.5
* CARB DIH @atom5 @atom0 @atom1 @atom2 -60.0 2.5
*

label donext

label skipcarb