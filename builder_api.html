

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>System Building with Dabble &mdash; Dabble 2.7.6 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Dabble 2.7.6 documentation" href="index.html"/>
        <link rel="next" title="Parameterization with Dabble" href="parameter_api.html"/>
        <link rel="prev" title="Command-line Usage" href="command_line.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Dabble
          

          
          </a>

          
            
            
              <div class="version">
                2.7.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">System Building with Dabble</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-system-building">Basic system building</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manipulating-single-molecules">Manipulating single molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-multiple-molecule-files">Working with multiple molecule files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameter_api.html">Parameterization with Dabble</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility_programs.html">Utility Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_examples.html">API Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Dabble</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>System Building with Dabble</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/builder_api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="system-building-with-dabble">
<span id="builder-api"></span><h1>System Building with Dabble<a class="headerlink" href="#system-building-with-dabble" title="Permalink to this headline">¶</a></h1>
<p>Dabble includes a lot of functionality for building membrane protein
systems, proteins in a water box, and manipulating various molecule
file formats.</p>
<div class="section" id="basic-system-building">
<h2>Basic system building<a class="headerlink" href="#basic-system-building" title="Permalink to this headline">¶</a></h2>
<p>The command line invocation of Dabble constructs a <code class="docutils literal notranslate"><span class="pre">DabbleBuilder</span></code>
object. <code class="docutils literal notranslate"><span class="pre">DabbleBuilder.write</span></code> then does all of the work. This class
is a good place to look for methods that handle multiple VMD molecules,
and use other Dabble building functions.</p>
<dl class="class">
<dt id="Dabble.DabbleBuilder">
<em class="property">class </em><code class="descclassname">Dabble.</code><code class="descname">DabbleBuilder</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.DabbleBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds protein systems, optionally in a membrane.</p>
<p>Tiles box appropriately, inserts protein into box,
removes conflicts, trims excess solvent and adds ions.</p>
<dl class="attribute">
<dt id="Dabble.DabbleBuilder.molids">
<code class="descname">molids</code><a class="headerlink" href="#Dabble.DabbleBuilder.molids" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict str-&gt;int</em> -- Molecule IDs comprising system components</p>
</dd></dl>

<dl class="attribute">
<dt id="Dabble.DabbleBuilder.size">
<code class="descname">size</code><a class="headerlink" href="#Dabble.DabbleBuilder.size" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array len 3 of floats</em> -- Size of the x, y, and z dimensions of the system</p>
</dd></dl>

<dl class="attribute">
<dt id="Dabble.DabbleBuilder.solute_sel">
<code class="descname">solute_sel</code><a class="headerlink" href="#Dabble.DabbleBuilder.solute_sel" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> -- VMD atom selection string for original solute</p>
</dd></dl>

<dl class="attribute">
<dt id="Dabble.DabbleBuilder.opts">
<code class="descname">opts</code><a class="headerlink" href="#Dabble.DabbleBuilder.opts" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dictionary</em> -- All options passed to the system builder</p>
</dd></dl>

<dl class="attribute">
<dt id="Dabble.DabbleBuilder.tmp_dir">
<code class="descname">tmp_dir</code><a class="headerlink" href="#Dabble.DabbleBuilder.tmp_dir" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> -- Directory in which to save temporary files</p>
</dd></dl>

<dl class="attribute">
<dt id="Dabble.DabbleBuilder.water_only">
<code class="descname">water_only</code><a class="headerlink" href="#Dabble.DabbleBuilder.water_only" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> -- If the solvent is just a water box</p>
</dd></dl>

<dl class="method">
<dt id="Dabble.DabbleBuilder.add_molecule">
<code class="descname">add_molecule</code><span class="sig-paren">(</span><em>filename</em>, <em>desc</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.DabbleBuilder.add_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a molecule file to the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) -- File to load</li>
<li><strong>desc</strong> (<em>str</em>) -- Type of molecule: solute, solvent, etc</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if the molecule was successfully added</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Dabble.DabbleBuilder.convert_ions">
<code class="descname">convert_ions</code><span class="sig-paren">(</span><em>salt_conc</em>, <em>cation</em>, <em>molid</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.DabbleBuilder.convert_ions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the charge of the molecule and adds salt ions to get the
desired concentration by converting water molecules to salt</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>salt_conc</strong> (<em>float</em>) -- Desired salt concentration in M</li>
<li><strong>cation</strong> (<em>str</em>) -- Cation to add, either Na or K</li>
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule id to consider</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(int) number of ions added</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">ValueError if invalid cation is specified</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Dabble.DabbleBuilder.get_cell_size">
<code class="descname">get_cell_size</code><span class="sig-paren">(</span><em>mem_buf</em>, <em>wat_buf</em>, <em>molid=None</em>, <em>filename=None</em>, <em>zh_mem_full=25.0</em>, <em>zh_mem_hyd=15.0</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.DabbleBuilder.get_cell_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the cell size of the final system given initial system and
buffers. Detects whether or not a membrane is present. Sets the
size of the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mem_buf</strong> (<em>float</em>) -- Membrane (xy) buffer amount</li>
<li><strong>wat_buf</strong> (<em>float</em>) -- Water (z) buffer amount</li>
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to consider (can't use with filename)</li>
<li><strong>filename</strong> (<em>str</em>) -- Filename of system to consider (can't use w molid)</li>
<li><strong>zh_mem_full</strong> (<em>float</em>) -- Membrane thickness</li>
<li><strong>zh_mem_hyd</strong> (<em>float</em>) -- Membrane hydrophobic region thickness</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:
return dx_sol, dy_sol, dx_tm, dy_tm, dz_full</p>
<blockquote>
<div><dl class="docutils">
<dt>(float tuple): x solute dimension, y solute dimension,</dt>
<dd>TM x solute dimension, TM y solute dimension, solute z dimension</dd>
</dl>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> -- if filename and molid are both specified</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Dabble.DabbleBuilder.remove_molecule">
<code class="descname">remove_molecule</code><span class="sig-paren">(</span><em>desc</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.DabbleBuilder.remove_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a molecule file from the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>desc</strong> (<em>str</em>) -- Key for molecule to remove</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">true if a molecule was deleted, false otherwise</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">KeyError if there is no molecule with that key string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Dabble.DabbleBuilder.write">
<code class="descname">write</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.DabbleBuilder.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the final built system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) -- Name of file</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="manipulating-single-molecules">
<h2>Manipulating single molecules<a class="headerlink" href="#manipulating-single-molecules" title="Permalink to this headline">¶</a></h2>
<p>Dabble provides many functions for manipulating molecules using
both the VMD atom selection language as well as use of intermediate
molecules. These may be found in the <code class="docutils literal notranslate"><span class="pre">molutils</span></code> module.</p>
<span class="target" id="module-Dabble.molutils"></span><p>This module contains functions for manipulating molecules using
the VMD python API.</p>
<dl class="function">
<dt id="Dabble.molutils.atomsel_remaining">
<code class="descclassname">Dabble.molutils.</code><code class="descname">atomsel_remaining</code><span class="sig-paren">(</span><em>molid</em>, <em>sel</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.atomsel_remaining" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects all remaining atoms. Whether or not an atom is counted
is determined by value of the beta flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule id to consider</li>
<li><strong>sel</strong> (<em>str</em>) -- VMD atom selection string to grab, defaults to all</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">VMD atomsel object representing the selection, or None
if no atoms matched the selection</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.center_system">
<code class="descclassname">Dabble.molutils.</code><code class="descname">center_system</code><span class="sig-paren">(</span><em>molid</em>, <em>tmp_dir</em>, <em>center_z=False</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.center_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Centers an entire system in the XY-plane, and optionally in the Z
dimension. Needs to save and reload the file in case the current
positions need to be concatenated to produce a new file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule id to center</li>
<li><strong>tmp_dir</strong> (<em>str</em>) -- Directory to create temp file in</li>
<li><strong>center_z</strong> (<em>bool</em>) -- Whether or not to center along the Z axis as well</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">VMD molecule id of centered system</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(int)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.combine_molecules">
<code class="descclassname">Dabble.molutils.</code><code class="descname">combine_molecules</code><span class="sig-paren">(</span><em>input_ids</em>, <em>tmp_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.combine_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines input molecules, closes them and returns the molecule id
of the new molecule that combines them, putting it on top.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_ids</strong> (<em>list of int</em>) -- Molecule IDs to combine, will be closed</li>
<li><strong>tmp_dir</strong> (<em>str</em>) -- Directory to put combined molecule into</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(int) molid of combined system</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.diameter">
<code class="descclassname">Dabble.molutils.</code><code class="descname">diameter</code><span class="sig-paren">(</span><em>coords</em>, <em>chunkmem=30000000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the diameter of a set of xy coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coords</strong> (<em>numpy array Nx2</em>) -- XY coordinates to get diameter of</li>
<li><strong>chunkmem</strong> (<em>int</em>) -- Chunk memory for calculation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The diameter of the stuff in both dimensions</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float, float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.get_net_charge">
<code class="descclassname">Dabble.molutils.</code><code class="descname">get_net_charge</code><span class="sig-paren">(</span><em>sel</em>, <em>molid</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.get_net_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the net charge of an atom selection, using the charge
field of the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sel</strong> (<em>str</em>) -- VMD atom selection to compute the charge of</li>
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule id to select within</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The rounded net charge of the selection</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(int)</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Throws:</dt>
<dd>ValueError: If charge does not round to an integer value</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.get_num_salt_ions_needed">
<code class="descclassname">Dabble.molutils.</code><code class="descname">get_num_salt_ions_needed</code><span class="sig-paren">(</span><em>molid</em>, <em>conc</em>, <em>water_sel='water and element O'</em>, <em>cation='Na'</em>, <em>anion='Cl'</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.get_num_salt_ions_needed" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the number of salt ions needed to put the system at a given
concentration of salt.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- The VMD molecule ID to consider</li>
<li><strong>conc</strong> (<em>float</em>) -- Desired salt concentration</li>
<li><strong>water_sel</strong> (<em>str</em>) -- VMD atom selection for water</li>
<li><strong>cation</strong> (<em>str</em>) -- Cation to use, either Na or K right now</li>
<li><strong>anion</strong> (<em>str</em>) -- Anion to use, only Cl currently supported</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt># cations needed, # anions needed, number of waters</dt>
<dd><p class="first last">that will remain, total # cations, total # anions,
cation concentration, anion concentration</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">(float tuple)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><em>Exception if number of cations and the net cation charge are</em> -- not equal (should never happen)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.get_system_dimensions">
<code class="descclassname">Dabble.molutils.</code><code class="descname">get_system_dimensions</code><span class="sig-paren">(</span><em>molid</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.get_system_dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the periodic box dimensions of a system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to consider</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A, B, C box dimensions</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(float tuple)</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body">ValueError if no box is found</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.get_system_net_charge">
<code class="descclassname">Dabble.molutils.</code><code class="descname">get_system_net_charge</code><span class="sig-paren">(</span><em>molid</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.get_system_net_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the net charge of the entire system.
What is in the system is defined by the beta field, as atoms that won't
be written have beta 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molid</strong> (<em>int</em>) -- VMD molecule id to compute the charge of</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The net charge of the molecule</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(int)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.lipid_composition">
<code class="descclassname">Dabble.molutils.</code><code class="descname">lipid_composition</code><span class="sig-paren">(</span><em>lipid_sel</em>, <em>molid</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.lipid_composition" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the lipid composition of each leaflet of the membrane</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lipid_sel</strong> (<em>str</em>) -- VMD selection string for lipid</li>
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to consider</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(int tuple) number of lipids on inner and outer membrane leaflets</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.num_atoms_remaining">
<code class="descclassname">Dabble.molutils.</code><code class="descname">num_atoms_remaining</code><span class="sig-paren">(</span><em>molid</em>, <em>sel='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.num_atoms_remaining" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of atoms remaining in the system, indicated
by the value of the beta flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule id to consider</li>
<li><strong>sel</strong> (<em>str</em>) -- VMD atom selection to count, defaults to all</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(int) number of atoms remaining in the system</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.num_lipids_remaining">
<code class="descclassname">Dabble.molutils.</code><code class="descname">num_lipids_remaining</code><span class="sig-paren">(</span><em>molid</em>, <em>lipid_sel</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.num_lipids_remaining" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of lipids remaining in the system, indicated
by the value of the beta flag. Uses the fragment notation to count
the number of lipids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to consider</li>
<li><strong>lipid_sel</strong> (<em>str</em>) -- VMD atom selection that counts as lipid</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(int) number of lipid molecules remaining in the system</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>ValueError if empty lipid selection</li>
<li>ValueError if non-existent molecule given</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.num_waters_remaining">
<code class="descclassname">Dabble.molutils.</code><code class="descname">num_waters_remaining</code><span class="sig-paren">(</span><em>molid</em>, <em>water_sel='water and element O'</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.num_waters_remaining" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of waters remaining in the system, indicated
by the value of the beta flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule id to consider</li>
<li><strong>sel</strong> (<em>str</em>) -- VMD atom selection that counts as water, defaults
to 'water and element O'</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(int) number of water molecules remaining in the system</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>ValueError if empty water selection</li>
<li>ValueError if non-existent molecule given</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.print_lipid_composition">
<code class="descclassname">Dabble.molutils.</code><code class="descname">print_lipid_composition</code><span class="sig-paren">(</span><em>lipid_sel</em>, <em>molid</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.print_lipid_composition" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the composition of the inner and outer leaflet</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule id to look at</li>
<li><strong>lipid_sel</strong> (<em>str</em>) -- VMD atom selection for lipid</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(str) string describing the lipid composition</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.set_cations">
<code class="descclassname">Dabble.molutils.</code><code class="descname">set_cations</code><span class="sig-paren">(</span><em>molid</em>, <em>element</em>, <em>filter_sel='none'</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.set_cations" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all of the specified atoms to a cation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to consider</li>
<li><strong>element</strong> (<em>str in Na</em><em>, </em><em>K</em>) -- Cation to convert</li>
<li><strong>filter_sel</strong> (<em>str</em>) -- VMD atom selection string for atoms to convert</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">ValueError if invalid cation specified</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.set_ion">
<code class="descclassname">Dabble.molutils.</code><code class="descname">set_ion</code><span class="sig-paren">(</span><em>molid</em>, <em>atom_id</em>, <em>element</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.set_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets an atom to be the desired ion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule to operate on</li>
<li><strong>atom_id</strong> (<em>int</em>) -- Atom index to change to ion</li>
<li><strong>element</strong> (<em>str in Na</em><em>, </em><em>K</em><em>, </em><em>Cl</em>) -- Ion to apply</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">ValueError if the index to change is not present</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.solute_xy_diameter">
<code class="descclassname">Dabble.molutils.</code><code class="descname">solute_xy_diameter</code><span class="sig-paren">(</span><em>solute_sel</em>, <em>molid</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.solute_xy_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the XY diameter of a set of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>solute_sel</strong> (<em>str</em>) -- VMD atom selection to get diameter of</li>
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to select within</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(float, float) X and Y diameter of the selection</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.molutils.tile_system">
<code class="descclassname">Dabble.molutils.</code><code class="descname">tile_system</code><span class="sig-paren">(</span><em>input_id</em>, <em>times_x</em>, <em>times_y</em>, <em>times_z</em>, <em>tmp_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.molutils.tile_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Tiles the membrane or solvent system the given number of times
in each direction to produce a larger system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_id</strong> (<em>int</em>) -- VMD molecule id to tile</li>
<li><strong>times_x</strong> (<em>int</em>) -- Number of times to tile in x direction</li>
<li><strong>times_y</strong> (<em>int</em>) -- Number of times to tile in y direction</li>
<li><strong>times_z</strong> (<em>int</em>) -- Number of times to tile in z direction</li>
<li><strong>tmp_dir</strong> (<em>str</em>) -- Directory in which to put temporary files</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(int) VMD molecule ID of tiled system</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="working-with-multiple-molecule-files">
<h2>Working with multiple molecule files<a class="headerlink" href="#working-with-multiple-molecule-files" title="Permalink to this headline">¶</a></h2>
<p>When constructing a system, Dabble performs operations such as tiling
template membrane pieces, merging those pieces with a protein, and
deleting atoms that are in the way. The <code class="docutils literal notranslate"><span class="pre">fileutils</span></code> module provides
functionality for doing these things.</p>
<p>All intermediate files are in the <code class="docutils literal notranslate"><span class="pre">mae</span></code> file format, as it provides
explicit connectivity and charge information, and allows combination of
multiple molecules for easy combining of systems without renumbering
all of the atoms. It is also easily extensible and not too difficult
to parse.</p>
<span class="target" id="module-Dabble.fileutils"></span><p>This module contains functions for manipulating files using
the VMD python API.</p>
<dl class="function">
<dt id="Dabble.fileutils.check_out_type">
<code class="descclassname">Dabble.fileutils.</code><code class="descname">check_out_type</code><span class="sig-paren">(</span><em>value</em>, <em>forcefield</em>, <em>hmr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.fileutils.check_out_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the file format of the requiested output is supported, and sets
internal variables as necessary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>str</em>) -- Filename requested</li>
<li><strong>forcefield</strong> (<em>str</em>) -- Force field requested</li>
<li><strong>hmr</strong> (<em>bool</em>) -- If hydrogen mass repartitioning is requested</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The requested output format</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> -- if the output format requested is currently unsupported</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code> -- if hydrogen mass repartitioning is requested
for amber files</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.fileutils.check_write_ok">
<code class="descclassname">Dabble.fileutils.</code><code class="descname">check_write_ok</code><span class="sig-paren">(</span><em>filename</em>, <em>out_fmt</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.fileutils.check_write_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the output files for the requested format exists,
and prints out an error message if the current options
don't allow overwriting them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) -- Output filename requested</li>
<li><strong>out_fmt</strong> (<em>str</em>) -- Output format requested. All intermediate</li>
<li><strong>involved in writing to this format will be checked for</strong> (<em>files</em>) -- </li>
<li><strong>existence.</strong> -- </li>
<li><strong>overwrite</strong> (<em>bool</em>) -- True if overwriting is allowed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if it okay to overwrite
Quits the program otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.fileutils.concatenate_mae_files">
<code class="descclassname">Dabble.fileutils.</code><code class="descname">concatenate_mae_files</code><span class="sig-paren">(</span><em>output_filename</em>, <em>input_filenames=None</em>, <em>input_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.fileutils.concatenate_mae_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenates several mae files together into one. Since this file format
allows concatenation, the new file is a combined system of all
the input molecules superimposed.
Either takes a list of files to concatenate, or a list of VMD molecule
ids. If molecule ids are given, VMD's interface is used to get the filename
corresponding to each id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>output_filename</strong> (<em>str</em>) -- Filename to write</li>
<li><strong>input_filenames</strong> (<em>list of str</em>) -- List of input mae files to combine, OR:</li>
<li><strong>input_ids</strong> (<em>list of int</em>) -- List of input molecules to combine</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if successful</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> -- if input_filenames and input_ids are both specified</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">AssertionError</span></code> -- if there are no input files</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.fileutils.load_solute">
<code class="descclassname">Dabble.fileutils.</code><code class="descname">load_solute</code><span class="sig-paren">(</span><em>filename</em>, <em>tmp_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.fileutils.load_solute" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a molecule input file, guessing the format from the extension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) -- Filename to load</li>
<li><strong>tmp_dir</strong> (<em>str</em>) -- Directory to put temporary files in</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(int) VMD molecule ID that was loaded</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">ValueError if filetype is currently unsupported</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.fileutils.write_ct_blocks">
<code class="descclassname">Dabble.fileutils.</code><code class="descname">write_ct_blocks</code><span class="sig-paren">(</span><em>molid</em>, <em>sel</em>, <em>output_filename</em>, <em>tmp_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.fileutils.write_ct_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a mae format file containing the specified selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule ID to write</li>
<li><strong>sel</strong> (<em>str</em>) -- the selection to write</li>
<li><strong>output_filename</strong> (<em>str</em>) -- the file to write to, including .mae extension</li>
<li><strong>tmp_dir</strong> (<em>str</em>) -- Directory to put files in</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the number of CT blocks written</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">length (int)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Dabble.fileutils.write_final_system">
<code class="descclassname">Dabble.fileutils.</code><code class="descname">write_final_system</code><span class="sig-paren">(</span><em>out_fmt</em>, <em>out_name</em>, <em>molid</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#Dabble.fileutils.write_final_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the final output in whatever format(s) are requested.
Always writes a mae format file as well</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>out_name</strong> (<em>str</em>) -- Filename to output to</li>
<li><strong>out_fmt</strong> (<em>str</em>) -- format to write the output to</li>
<li><strong>molid</strong> (<em>int</em>) -- VMD molecule_id to write</li>
<li><strong>tmp_dir</strong> (<em>str</em>) -- Directory to put temporary files in</li>
<li><strong>extra_topos</strong> (<em>list of str</em>) -- Extra topology files to use</li>
<li><strong>extra_params</strong> (<em>list of str</em>) -- Extra parameter files to use</li>
<li><strong>extra_streams</strong> (<em>list of str</em>) -- Extra stream files to use</li>
<li><strong>lipid_sel</strong> (<em>str</em>) -- Lipid selection</li>
<li><strong>hmassrepartition</strong> (<em>bool</em>) -- Whether or not to repartition hydrogen
masses</li>
<li><strong>debug_verbose</strong> (<em>bool</em>) -- Extra debug output from tleap</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(str) main final filename written</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parameter_api.html" class="btn btn-neutral float-right" title="Parameterization with Dabble" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="command_line.html" class="btn btn-neutral" title="Command-line Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Robin Betz.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.7.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>